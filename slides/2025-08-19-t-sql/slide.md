---
marp: true
theme: standard
size: 16:9
paginate: true
header: "SQL Server T-SQL入門"
footer: "ムツミックス  2025-08-19"
---

<!-- _class: cover -->

# SQLServer の T-SQL の使い方について

## 初心者向けガイド

### 発表者: ムツミックス

#### 日付: 2025-08-19

<!--
このプレゼンテーションでは、T-SQLの基本的な使い方を初心者向けに解説します
時間: 5分間のライトニングトーク
対象: T-SQLに初めて触れる方、SQLの基本を学びたい方
-->

---

<!-- _class: section-title -->

# アジェンダ

---

## 今日のアジェンダ

1. **T-SQL とは何か**
2. **基本的なデータ操作**
3. **条件指定とフィルタリング**
4. **集計と関数**
5. **実際に使ってみよう**

<!--
5分間で T-SQL の基本的な概念と使い方を理解してもらいます
実践的な例を中心に、すぐに使える知識をお伝えします
-->

---

<!-- _class: section-title -->

# T-SQL とは何か

---

## T-SQL とは

**T-SQL（Transact-SQL）** は、Microsoft SQL Server で使用される
拡張 SQL です。

### 特徴

- **標準 SQL** + Microsoft 独自の拡張機能
- **ストアドプロシージャ** の作成が可能
- **変数** や **制御構文** が使用できる

### 使用場面

- データベースの操作・管理
- レポート作成
- システム開発

<!--
T-SQLはSQL Serverの標準的なクエリ言語です
一般的なSQLに加えて、プログラミング的な機能も提供されています
まずは基本的なデータ操作から始めましょう
-->

---

<!-- _class: section-title -->

# 基本的なデータ操作

---

## 基本的な SELECT 文

```sql
-- 全てのデータを取得
SELECT * FROM 社員テーブル;

-- 特定の列のみ取得
SELECT 社員名, 部署 FROM 社員テーブル;

-- 重複を除去
SELECT DISTINCT 部署 FROM 社員テーブル;
```

### ポイント

- **SELECT**: データを取得する基本コマンド
- **FROM**: 対象テーブルを指定
- **DISTINCT**: 重複行を除去

<!--
SELECTはT-SQLの基本中の基本です
まずは全データを見て、必要な列だけを選択する習慣をつけましょう
DISTINCTは重複データを確認するときに便利です
-->

---

<!-- _class: section-title -->

# 条件指定とフィルタリング

---

## WHERE 句による条件指定

```sql
-- 条件に一致するデータを取得
SELECT * FROM 社員テーブル
WHERE 部署 = '営業部';

-- 複数条件
SELECT * FROM 社員テーブル
WHERE 部署 = '営業部' AND 年齢 >= 30;

-- パターンマッチング
SELECT * FROM 社員テーブル
WHERE 社員名 LIKE '田中%';
```

### よく使う演算子

- **=, <>, <, >, <=, >=**: 比較演算子
- **AND, OR, NOT**: 論理演算子
- **LIKE**: パターンマッチング

<!--
WHERE句でデータをフィルタリングできます
ANDとORを使って複数の条件を組み合わせることができます
LIKEは部分一致検索に便利で、%は任意の文字列を表します
-->

---

<!-- _class: section-title -->

# 集計と関数

---

## 集計関数と GROUP BY

```sql
-- 基本的な集計
SELECT COUNT(*) FROM 社員テーブル;

-- グループ化して集計
SELECT 部署, COUNT(*) as 人数
FROM 社員テーブル
GROUP BY 部署;

-- 条件付き集計
SELECT 部署, AVG(年齢) as 平均年齢
FROM 社員テーブル
GROUP BY 部署
HAVING COUNT(*) >= 3;
```

### 主な集計関数

- **COUNT**: 件数をカウント
- **SUM**: 合計値を計算
- **AVG**: 平均値を計算

<!--
集計関数はデータ分析の基本です
GROUP BYで項目別に集計し、HAVINGでグループに条件を設定できます
AVG、SUMなど用途に応じて使い分けましょう
-->

---

<!-- _class: section-title -->

# 実際に使ってみよう

---

## 実践例：売上レポート

```sql
-- 月別売上集計
SELECT
    YEAR(売上日) as 年,
    MONTH(売上日) as 月,
    SUM(金額) as 売上合計
FROM 売上テーブル
WHERE 売上日 >= '2024-01-01'
GROUP BY YEAR(売上日), MONTH(売上日)
ORDER BY 年, 月;
```

### 実用的なテクニック

- **日付関数**: YEAR(), MONTH(), DAY()
- **ORDER BY**: 結果の並び替え
- **条件**: 期間指定でデータを絞り込み

<!--
実際のビジネスでよく使われる売上レポートの例です
日付関数を使って年月で集計し、ORDER BYで見やすくソートしています
このパターンは様々な集計で応用できます
-->

---

<!-- _class: section-title -->

# まとめ

---

## T-SQL 学習のポイント

### 今日学んだこと

1. **SELECT 文** でデータを取得
2. **WHERE 句** で条件指定
3. **集計関数** でデータを分析
4. **GROUP BY** でグループ化

### 次のステップ

- **JOIN** による表結合
- **ストアドプロシージャ** の作成
- **インデックス** による性能向上

**まずは基本の SELECT から始めて、**
**徐々に複雑なクエリに挑戦しましょう！**

<!--
T-SQLの基本を押さえました
まずは今日の内容を実際に試してみてください
エラーを恐れずに、様々なクエリを書いて練習することが上達の近道です
質問があれば遠慮なくお聞きください
-->
